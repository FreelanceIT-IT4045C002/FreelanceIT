<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>In Progress Page</title>
  <!-- Bootstrap CSS -->
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f8f9fa;
    }
    .card {
      background-color: #ffffff;
      border: 1px solid #dee2e6;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      flex: 1;
      margin: 10px;
      cursor: pointer;
    }

    h2, h3 {
      color: #343a40;
      text-align: left;
    }

    .main-content {
      padding: 20px;
    }
    .side-menu img {
      width: 40px;
      border-radius: 50%;
    }
  </style>
  <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
  <link rel="stylesheet" th:href="@{//cdn.datatables.net/2.1.8/css/dataTables.dataTables.min.css}">

  <!-- Custom CSS -->
  <link rel="stylesheet" th:href="@{/css/layout.css}">
  <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

<!-- Top Nav -->
<div th:replace="fragments/topnav :: navbar"></div>

<main class="main-content container">
  <section class="project-section">
    <h2>Project Overview</h2>
    <div class="tasks mb-4">
      <h3>Your Tasks</h3>
      <div class="row" id="taskCards">
        <!-- Dynamically generated task cards will go here -->
      </div>
      <div class="add-task-card card text-center mt-3">
        <a href="/add/todo" class="text-decoration-none">
          <p class="display-4 text-primary">+</p>
          <span>Add New Task</span>
        </a>
      </div>
    </div>
  </section>

  <section class="logs-section">
    <h3>Logs</h3>
    <p>January - March 2024</p>
  </section>
</main>

<footer class="footer mt-auto py-3 bg-light text-center">
  <button class="btn btn-primary clock-in-button">Clock In</button>
</footer>

  <script>
  // Function to load tasks from localStorage and display them
  function loadTasks() {
    const taskCardsContainer = document.getElementById('taskCards');
    const tasks = JSON.parse(localStorage.getItem('tasks')) || []; // Replace with data from your backend if needed.

    taskCardsContainer.innerHTML = ''; // Clear existing tasks

    tasks.forEach((task) => {
      const taskCard = document.createElement('div');
      taskCard.className = 'task-card';
      taskCard.innerHTML = `
      <p>${task.title}</p>
      <span>${task.description}</span>
      <span>Assigned to: ${task.assigned}</span>
      <button onclick="deleteTask(${task.id})">Delete</button> <!-- Call deleteTask here -->
    `;
      taskCardsContainer.appendChild(taskCard);
    });
  }

  // Function to delete a task
  function deleteTask(taskId) {
    fetch(`/delete/task?id=${taskId}`, {
      method: 'DELETE',
    })
            .then(response => response.text())
            .then(data => {
              alert(data); // Show response message
              loadTasks(); // Reload tasks to refresh the displayed list
            })
            .catch(error => console.error('Error deleting task:', error));
  }


  // Call loadTasks on page load
  window.onload = loadTasks;
</script>

</body>
</html>


<!-- Bootstrap JS, Popper.js, and jQuery -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
